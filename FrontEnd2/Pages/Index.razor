@page "/"

@inject Blazored.LocalStorage.ILocalStorageService localStorage
@inject NavigationManager NavigationManager

@*@if (email != null)
{
    NavigationManager.NavigateTo("shoppinglist");
}
else
{
    
    NavigationManager.NavigateTo("Login");
}*@

@code{
    string email;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            await GetLocalSession();
            localStorage.Changed += (sender, e) =>
            {
                Console.WriteLine($"Value for key {e.Key} changed from {e.OldValue} to {e.NewValue}");
            };
            if (email != null)
            {
                 NavigationManager.NavigateTo("shoppinglist");
            }
            else
            {
                NavigationManager.NavigateTo("Login");
            }

            StateHasChanged();
        }

    }
    async Task GetLocalSession()
    {
        email = await localStorage.GetItemAsync<string>("Email");
    }
}

